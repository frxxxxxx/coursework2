<%- include("../partials/head", { title: "–ì–ª–∞–≤–Ω–∞—è" }) %>
<%- include("../partials/header") %>

<main class="container page">
  <section class="hero">
    <div class="hero__grid">
      <div class="hero__main">
        <h1 class="hero__title">–ü—É–ª—å—Å –∑–∞–º–µ—Ç–æ–∫, –∏–¥–µ–π –∏ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</h1>
        <p class="hero__lead">
          PulseBlog ‚Äî –∞–∫–∫—É—Ä–∞—Ç–Ω–∞—è –±–ª–æ–≥-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞: —Ç–µ–≥–∏, –ª–∞–π–∫–∏, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ —Å–≤–æ–π –∫–∞–±–∏–Ω–µ—Ç –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤.
        </p>
        <div class="hero__actions">
          <a class="btn btn--primary" href="/feed">–û—Ç–∫—Ä—ã—Ç—å –ª–µ–Ω—Ç—É</a>
          <% if (currentUser) { %>
            <a class="btn btn--ghost" href="/dashboard/posts/new">–ù–∞–ø–∏—Å–∞—Ç—å –ø–æ—Å—Ç</a>
          <% } else { %>
            <a class="btn btn--ghost" href="/auth/register">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</a>
          <% } %>
        </div>
      </div>

      <aside class="hero__side">
        <div class="card card--glow">
          <div class="card__title">–¢–æ–ø-—Ç–µ–≥–∏</div>
          <div class="tagcloud">
            <% tags.forEach(t => { %>
              <a class="tag" href="/tags/<%= t.slug %>">
                <span class="tag__name"><%= t.name %></span>
                <span class="tag__cnt"><%= t.cnt %></span>
              </a>
            <% }) %>
          </div>
        </div>

        <div class="ticker" aria-label="–ü–æ–¥—Å–∫–∞–∑–∫–∞">
          <div class="ticker__line">
            <span>‚ú® –±—ã—Å—Ç—Ä—ã–π —Å–∏–¥–µ—Ä ‚Ä¢ 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Ä¢ 30 –ø–æ—Å—Ç–æ–≤ ‚Ä¢ –∞–¥–º–∏–Ω–∫–∞ ‚Ä¢ –∞–¥–∞–ø—Ç–∏–≤</span>
            <span>‚ú® –±—ã—Å—Ç—Ä—ã–π —Å–∏–¥–µ—Ä ‚Ä¢ 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Ä¢ 30 –ø–æ—Å—Ç–æ–≤ ‚Ä¢ –∞–¥–º–∏–Ω–∫–∞ ‚Ä¢ –∞–¥–∞–ø—Ç–∏–≤</span>
          </div>
        </div>
      </aside>
    </div>
  </section>

  <section class="section">
    <div class="section__head">
      <h2 class="section__title">–°–≤–µ–∂–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</h2>
      <a class="link" href="/feed">–≤—Å—è –ª–µ–Ω—Ç–∞ ‚Üí</a>
    </div>

    <div class="grid">
      <% posts.forEach(p => { %>
        <article class="postcard">
          <a class="postcard__cover" href="/post/<%= p.slug %>">
            <% if (p.cover_url) { %>
              <img src="<%= p.cover_url %>" alt="" loading="lazy" />
            <% } else { %>
              <div class="postcard__placeholder" aria-hidden="true"></div>
            <% } %>
          </a>

          <div class="postcard__body">
            <div class="postcard__meta">
              <a class="chip" href="/authors/<%= p.author_id %>"><%= p.author_name %></a>
              <span class="muted">‚Ä¢</span>
              <time class="muted" datetime="<%= p.published_at %>"><%= new Date(p.published_at).toLocaleDateString("ru-RU") %></time>
            </div>

            <h3 class="postcard__title">
              <a href="/post/<%= p.slug %>"><%= p.title %></a>
            </h3>

            <p class="postcard__text"><%= p.excerpt || "–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è ‚Äî –æ—Ç–∫—Ä–æ–π –ø–æ—Å—Ç, —Ç–∞–º –≤—Å—ë —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ." %></p>

            <div class="postcard__stats muted">
              <span>üí¨ <%= p.comments_count %></span>
              <span>‚ô• <%= p.likes_count %></span>
            </div>
          </div>
        </article>
      <% }) %>
    </div>

    <div class="pager">
      <a class="btn btn--ghost <%= page<=1 ? 'is-disabled' : '' %>" href="/?page=<%= Math.max(1, page-1) %>">‚Üê</a>
      <div class="pager__info muted"><%= page %> / <%= totalPages %></div>
      <a class="btn btn--ghost <%= page>=totalPages ? 'is-disabled' : '' %>" href="/?page=<%= Math.min(totalPages, page+1) %>">‚Üí</a>
    </div>
  </section>
</main>

<%- include("../partials/footer") %>
